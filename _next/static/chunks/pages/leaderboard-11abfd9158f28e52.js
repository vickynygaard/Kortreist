(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[861],{917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(7876),s=r(2948),l=r(6733),n=r(2282);function o(){return(0,n.O)(),(0,a.jsxs)("div",{className:"flex flex-col  w-full",children:[(0,a.jsx)("div",{className:"w-full text-center",children:(0,a.jsx)("div",{className:"font-bold text-3xl text-violet-950 pb-6",children:"Ledertavle"})}),(0,a.jsx)(l.A,{}),(0,a.jsx)(s.A,{})]})}},2282:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var a=r(4232),s=r(9099),l=r(300);function n(){let e=(0,s.useRouter)(),{userData:t}=(0,l.r)();(0,a.useEffect)(()=>{if(!(null==t?void 0:t.accessToken))return;let r=e.pathname,a=["/","/profile","/team","/leaderboard"];"/profile"===r&&a.push("/profile/settings"),"/leaderboard"===r&&a.push("/leaderboard/company","/leaderboard/team"),"/"===r&&a.push("/travelForm","/challenges"),r.startsWith("/team")&&("/team"===r&&a.push("/team/dashboard","/team/onboarding"),"/team/dashboard"===r&&a.push("/team/onboarding"),"/team/onboarding"===r&&a.push("/team/dashboard")),a.filter(e=>e!==r).forEach(t=>e.prefetch(t))},[e.pathname,null==t?void 0:t.accessToken])}},2948:(e,t,r)=>{"use strict";let a;r.d(t,{A:()=>x});var s=r(7876),l=r(4232),n=r(4463),o=r(9625);let i=e=>{let{nickName:t,score:r,rank:a,profilePicture:l,visualPosition:i,type:c="user"}=e;return(0,s.jsxs)(o.P.div,{className:"flex flex-col items-center justify-end w-24 relative",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*i,duration:.6,type:"spring",stiffness:100},children:[(0,s.jsxs)("div",{className:"relative -mb-6 z-10",children:[a<=3&&(0,s.jsx)(n.A,{size:20,className:"absolute -top-4 left-1/2 -translate-x-1/2 ".concat(1===a?"text-yellow-500":2===a?"text-gray-300":"text-amber-600"," drop-shadow")}),(0,s.jsx)("img",{src:"".concat("/Kortreist","/images/").concat("team"===c?"team-pictures":"profile-pictures","/").concat(l||("team"===c?"teamAvatar1.png":"avatar1.png")),alt:t,className:"w-16 h-16 rounded-full border-4 ".concat({1:"border-yellow-400",2:"border-gray-300",3:"border-amber-600"}[a]||"border-gray-200"," object-cover bg-white")})]}),(0,s.jsxs)("div",{className:"w-full flex flex-col items-center justify-end ".concat((e=>1===e?"h-32":2===e?"h-24":3===e?"h-20":"h-16")(a)," bg-violet-900 text-white rounded-t-2xl pt-8 pb-2"),children:[(0,s.jsx)("span",{className:"text-xl font-bold",children:a}),(0,s.jsx)("span",{className:"text-base",children:r})]}),(0,s.jsx)("div",{className:"mt-2 h-8 w-full px-1 text-center",children:(0,s.jsx)("span",{className:"text-base font-bold bg-clip-text text-transparent bg-gradient-to-r from-pink-400 to-violet-600 line-clamp-2 leading-tight break-words",children:t})})]})},c=e=>{let{nickName:t,score:r,rank:a,profilePicture:l,type:n="user",isCurrentUser:o=!1}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 px-8 gap-4 border-b border-gray-500 last:border-b-0 h-[73px] ".concat(o?"bg-yellow-200/15":""),children:[(0,s.jsx)("span",{className:"font-bold w-6 text-center",children:a}),(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-grow",children:[(0,s.jsx)("img",{src:"".concat("/Kortreist","/images/").concat("team"===n?"team-pictures":"avatars","/").concat(l||("team"===n?"teamAvatar1.png":"Avatar1.png")),alt:t,className:"w-10 h-10 rounded-full border-2 border-customViolet object-cover"}),(0,s.jsx)("p",{className:"break-all max-w-[24rem] max-h-[3.5rem] overflow-hidden",children:t})]}),(0,s.jsx)("span",{className:"font-semibold text-customViolet",children:r})]})};var d=r(300),u=r(3784),f=r(7644),m=r(2142);{let e=localStorage.getItem("leaderboardData");if(e)try{a=JSON.parse(e)}catch(e){console.error("Failed to parse cached leaderboardData:",e)}}let x=e=>{let{users:t,loadingOverride:r=!1}=e,[n,o]=(0,l.useState)([]),[x,p]=(0,l.useState)([]),{userData:h,loading:b}=(0,d.r)(),{data:v,isLoading:j,error:g}=(0,u.g)("/api/users/all",null==h?void 0:h.accessToken,{refreshInterval:3e4,enabled:!!(null==h?void 0:h.accessToken),fallbackData:a}),{data:N,isLoading:w,error:y}=(0,u.g)("/api/profile/getUser",null==h?void 0:h.accessToken,{refreshInterval:0,revalidateOnFocus:!1,revalidateOnMount:!0,enabled:!!(null==h?void 0:h.accessToken)});(0,l.useEffect)(()=>{v&&localStorage.setItem("leaderboardData",JSON.stringify(v))},[v]);let k=null!=t?t:v;(0,l.useEffect)(()=>{if(!k)return;let e=[...k].sort((e,t)=>t.totalScore-e.totalScore),t=[],r=1;for(let a=0;a<e.length;a++)a>0&&e[a].totalScore===e[a-1].totalScore?t.push({...e[a],rank:t[a-1].rank}):t.push({...e[a],rank:r}),r++;o(t.slice(0,3)),p(t.slice(3))},[k]);let A=(0,m.o)(),S=t?r:b||j||w;if(g||y)return(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})});if(S&&A)return(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)(f.A,{})});let _=null==N?void 0:N.userId;return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"flex justify-center items-end gap-6 mt-10",children:[2,1,3].map(e=>{var t;let r=n[e-1];return r?(0,s.jsx)(i,{rank:r.rank,nickName:r.nickName,score:r.totalScore,profilePicture:r.profilePicture,visualPosition:e,type:null!==(t=r.type)&&void 0!==t?t:"user"},r.userId):null})}),(0,s.jsx)("div",{className:"mt-4 w-full rounded-t-lg bg-customYellow2/50 backdrop-blur-md",children:x.map(e=>{var t;return(0,s.jsx)(c,{rank:e.rank,nickName:e.nickName,score:e.totalScore,profilePicture:e.profilePicture,type:null!==(t=e.type)&&void 0!==t?t:"user",isCurrentUser:e.userId===_},e.userId)})})]})}},3784:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});var a=r(7596),s=r(9099),l=r.n(s),n=r(7685);async function o(e,t){let r={"Content-Type":"application/json"};t&&(r.Authorization="Bearer ".concat(t));let a=await fetch("".concat("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net").concat(e),{headers:r});if(!a.ok){if(428===a.status){n.Ay.error("Du m\xe5 fullf\xf8re registreringen f\xf8r du kan fortsette."),l().push("/onboarding");return}let e=await a.text();throw Error("Error: ".concat(a.statusText," - ").concat(e))}return a.json()}function i(e,t,r){var s;let l=(null===(s=null==r?void 0:r.enabled)||void 0===s||s)&&e&&t?[e,t]:null,{data:n,error:i,mutate:c}=(0,a.Ay)(l,()=>o(e,t),r);return{data:n,isLoading:!n&&!i,error:i,mutate:c}}},4513:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/leaderboard",function(){return r(917)}])},6733:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(7876),s=r(9099),l=r(8230),n=r.n(l);let o=e=>{let{href:t,title:r}=e,l=(0,s.useRouter)().pathname===t;return(0,a.jsxs)(n(),{href:t,className:"relative flex flex-col items-center justify-center w-1/3 text-center",children:[l&&(0,a.jsx)("span",{className:"absolute bottom-[-16px] left-1/2 w-full transform -translate-x-1/2 border-b-2 border-violet-900 z-0 transition-all duration-300"}),(0,a.jsx)("span",{className:"".concat(l?"text-violet-900":"text-gray-700"),children:r})]})},i=()=>(0,a.jsx)("nav",{className:"flex w-full justify-center p-4 font-medium",children:(0,a.jsxs)("div",{className:"flex w-full max-w-md justify-between",children:[(0,a.jsx)(o,{href:"/leaderboard",title:"Solo"}),(0,a.jsx)(o,{href:"/leaderboard/team",title:"Lag"}),(0,a.jsx)(o,{href:"/leaderboard/company",title:"Bedrift"})]})})},7644:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(7876);function s(){return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-customViolet"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[596,971,636,593,792],()=>t(4513)),_N_E=e.O()}]);