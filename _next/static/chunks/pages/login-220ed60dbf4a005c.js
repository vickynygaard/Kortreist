(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{300:(e,t,s)=>{"use strict";s.d(t,{r:()=>n});var i=s(4232),o=s(5051),a=s(4723),l=s(7526);let n=()=>{let{instance:e,accounts:t}=(0,o.dk)(),[s,n]=(0,i.useState)(null),[c,r]=(0,i.useState)(!0),[d,u]=(0,i.useState)(null),m=async t=>{try{var s;let i=await e.acquireTokenSilent({scopes:a.$.scopes,account:t}),o=i.idTokenClaims,l={email:(null===(s=o.emails)||void 0===s?void 0:s[0])||o.email||o.preferred_username||"",name:o.name||"".concat(o.given_name||""," ").concat(o.family_name||"").trim()||"Unknown User",idTokenClaims:o,idToken:i.idToken,accessToken:i.accessToken};n(l)}catch(t){if(t instanceof l.CB)try{await e.loginRedirect(a.$)}catch(e){u("Login required: "+e)}else u("Failed to acquire token: "+t)}};return(0,i.useEffect)(()=>{(async()=>{try{let s;await e.initialize(),await e.handleRedirectPromise()?s=e.getAllAccounts()[0]:t.length>0&&(s=t[0]),s&&await m(s)}catch(e){u("MSAL initialization error: "+e)}finally{r(!1)}})()},[e]),{userData:s,loading:c,error:d}}},6069:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var i=s(7876),o=s(4232),a=s(5051),l=s(4723);let n=e=>{let{onClick:t,icon:s,title:o,description:a,className:l}=e;return(0,i.jsxs)("button",{onClick:t,className:"flex flex-col items-center justify-center border-2 border-violet-900 text-violet-900 px-3 py-2 rounded-md transition ".concat(l),children:[s&&(0,i.jsx)("div",{className:"mb-2",children:s}),(0,i.jsx)("span",{className:"text-lg font-semibold",children:o}),a&&(0,i.jsx)("p",{className:"text-sm opacity-80",children:a})]})};var c=s(4587),r=s.n(c),d=s(9099),u=s(300);let m=()=>{let{userData:e}=(0,u.r)(),{instance:t,accounts:s,inProgress:c}=(0,a.dk)(),[m,h]=(0,o.useState)(!1),f=(0,d.useRouter)();(0,o.useEffect)(()=>{(async()=>{if((null==e?void 0:e.accessToken)&&"none"===c)try{let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Users/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({})});if(!t.ok)throw Error("Serverfeil: ".concat(t.statusText));let s=await t.json();console.log("✅ User upserted:",s),s.isProfileComplete?f.push("/"):f.push("/onboarding")}catch(e){console.error("❌ Feil ved oppdatering:",e)}})()},[null==e?void 0:e.accessToken,c]);let p=async()=>{h(!0);try{await t.loginRedirect({...l.$,prompt:"login"})}catch(e){console.error("Login error:",e)}finally{h(!1)}},x=async()=>{console.log("Create Account button clicked")};return(0,i.jsxs)("div",{className:"fixed inset-0 bg-customYellow2 overflow-hidden flex flex-col",children:[(0,i.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center z-10",children:[(0,i.jsx)(r(),{src:"".concat("/Kortreist","/images/Logo.png"),alt:"Logo",width:120,height:120,className:"mb-4"}),(0,i.jsx)("h1",{className:"text-4xl font-semibold text-customViolet",children:"Kortreist"}),(0,i.jsxs)("div",{className:"flex flex-col gap-4 mt-12",children:[(0,i.jsx)(n,{onClick:p,title:"Logg Inn",className:"border-customViolet text-customViolet bg-white w-60",disabled:m||"none"!==c}),(0,i.jsx)(n,{onClick:x,title:"Opprett Konto",className:"border-customViolet text-white bg-customViolet w-60"})]})]}),(0,i.jsx)("div",{className:"w-full z-0",children:(0,i.jsx)(r(),{src:"".concat("/Kortreist","/images/Grass.png"),alt:"Scenery Illustration",width:850,height:303,className:"w-full object-contain"})})]})}},7984:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return s(6069)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[587,636,593,792],()=>t(7984)),_N_E=e.O()}]);