(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{3792:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(7876),r=s(4232),l=s(300),n=s(9099),o=s(4957);function c(){let{userData:e}=(0,l.r)(),[t,s]=(0,r.useState)([]),[c,i]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(""),[f,m]=(0,r.useState)(""),[x,b]=(0,r.useState)(!1),g=(0,n.useRouter)();(0,r.useEffect)(()=>{(null==e?void 0:e.accessToken)&&(async()=>{try{let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/allComp",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av selskaper");let a=await t.json();s(a)}catch(e){return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}})()},[null==e?void 0:e.accessToken]),(0,r.useEffect)(()=>{(null==e?void 0:e.accessToken)&&(async()=>{try{let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/getUser",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av brukerdata: ".concat(t.statusText));let s=await t.json();console.log("Fetched user profile:",s),i(s),s.companyId&&u(s.companyId),s.nickName&&p(s.nickName),s.address&&m(s.address)}catch(e){return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}})()},[null==e?void 0:e.accessToken]);let v=async()=>{if(!(null==e?void 0:e.accessToken)||!d||!h||!f){alert("Vennligst fyll ut alle felter.");return}b(!0);try{if(!(await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/companySet",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({companyId:d,nickName:h,address:f})})).ok)throw Error("Klarte ikke oppdatere profil");console.log("Brukerdata oppdatert"),g.push("/")}catch(e){return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}finally{b(!1)}};return(0,a.jsx)("div",{className:"bg-customYellow2 p-6 flex flex-col justify-center items-center",children:(0,a.jsxs)("div",{className:"w-full max-w-md bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-customViolet mb-6 text-center",children:"Fullf\xf8r profilen din"}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Velg selskap:"}),(0,a.jsxs)("select",{className:"w-full p-3 mb-4 rounded border",value:null!=d?d:"",onChange:e=>u(Number(e.target.value)),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Velg et selskap"}),t.map(e=>(0,a.jsx)("option",{value:e.companyId,children:e.name},e.companyId))]}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Kallenavn:"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 mb-4 rounded border",value:h,onChange:e=>p(e.target.value),placeholder:"F.eks. SuperPer"}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Adresse:"}),(0,a.jsx)(o.A,{selectedAddress:f,setSelectedAddress:m}),(0,a.jsx)("button",{onClick:v,disabled:x,className:"w-full bg-customViolet text-white p-3 rounded font-semibold hover:opacity-90 transition",children:x?"Lagrer...":"Fullf\xf8r"})]})})}},4957:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(7876),r=s(4232),l=s(300);function n(e){let{selectedAddress:t,setSelectedAddress:s,inputBgClass:n="bg-white"}=e,[o,c]=(0,r.useState)(t),[i,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),{userData:m}=(0,l.r)();async function x(e){h(!0);try{if(!(null==m?void 0:m.accessToken))return;let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/geocode?address=".concat(encodeURIComponent(e)),{headers:{Authorization:"Bearer ".concat(m.accessToken)}});if(!t.ok){console.error("Failed to fetch suggestions"),d([]);return}let s=await t.json();d(s.features||[])}catch(e){console.error("Error fetching suggestions",e),d([])}finally{h(!1)}}(0,r.useEffect)(()=>{c(t)},[t]),(0,r.useEffect)(()=>{if(!o.trim()){d([]);return}let e=setTimeout(()=>{x(o)},500);return()=>clearTimeout(e)},[o]);let b=e=>{c(e.properties.label),s(e.properties.label),d([]),f(!1)};return(0,a.jsxs)("div",{className:"address-autocomplete relative",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsx)("input",{type:"text",value:o,placeholder:"F.eks. Storgata 1, Oslo",onChange:e=>{c(e.target.value)},onFocus:()=>f(!0),onBlur:()=>{setTimeout(()=>{f(!1),o!==t&&c(t)},150)},className:"w-full p-3 rounded border ".concat(n," focus:outline-none focus:ring-2 focus:ring-customViolet")}),o&&(0,a.jsx)("button",{onClick:()=>{c(""),s(""),d([])},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),p&&!u&&i.length>0&&o.trim()&&(0,a.jsx)("ul",{className:"absolute z-10 w-full border border-gray-200 rounded shadow-md bg-white max-h-60 overflow-y-auto",children:i.map((e,t)=>(0,a.jsx)("li",{onMouseDown:()=>b(e),className:"p-2 hover:bg-gray-100 cursor-pointer",children:e.properties.label},"".concat(e.properties.osm_id,"-").concat(t)))}),p&&u&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-customViolet",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),(0,a.jsx)("span",{className:"text-gray-600",children:"Laster adresser..."})]}),p&&!u&&0===i.length&&o.trim()&&(0,a.jsxs)("div",{className:"p-2 text-gray-500 border rounded",children:["Ingen treff p\xe5 “",o,"”"]})]})}},6250:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding",function(){return s(3792)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6250)),_N_E=e.O()}]);