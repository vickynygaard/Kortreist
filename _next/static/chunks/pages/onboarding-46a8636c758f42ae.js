(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{724:(e,t,s)=>{"use strict";s.d(t,{y:()=>l});var a=s(1367),r=s.n(a);function l(e,t){var s,a,l;let n=null!==(s=null==t?void 0:t.minLength)&&void 0!==s?s:3,o=null!==(a=null==t?void 0:t.maxLength)&&void 0!==a?a:15,c=null!==(l=null==t?void 0:t.label)&&void 0!==l?l:"Kallenavn";return e.length<n?"".concat(c," m\xe5 v\xe6re minst ").concat(n," tegn."):e.length>o?"".concat(c," kan ikke v\xe6re lengre enn ").concat(o," tegn."):/^[A-Za-zÆØÅæøå0-9_ ]+$/.test(e)?r().check(e)||r().list().some(t=>e.toLowerCase().includes(t))?"Dette kallenavnet inneholder upassende spr\xe5k.":null:"Kallenavn kan kun inneholde bokstaver, tall, mellomrom og understrek."}},3792:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(7876),r=s(4232),l=s(300),n=s(9099),o=s(4957),c=s(724),i=s(7685);function d(){let{userData:e}=(0,l.r)(),[t,s]=(0,r.useState)([]),[d,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),[g,b]=(0,r.useState)(""),[k,x]=(0,r.useState)(""),[v,w]=(0,r.useState)(!1),[y,N]=(0,r.useState)(null),[j,S]=(0,r.useState)(null),T=(0,n.useRouter)(),_=e=>{let t=e.target.value;b(t),N((0,c.y)(t))};(0,r.useEffect)(()=>{(null==e?void 0:e.accessToken)&&(async()=>{try{let t=await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/Profile/allComp",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av selskaper");let a=await t.json();s(a)}catch(e){console.error(e)}})()},[null==e?void 0:e.accessToken]),(0,r.useEffect)(()=>{(null==e?void 0:e.accessToken)&&(async()=>{try{let t=await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/Profile/getUser",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av brukerdata: ".concat(t.statusText));let s=await t.json();u(s),s.companyId&&h(s.companyId),s.nickName&&(b(s.nickName),_({target:{value:s.nickName}})),s.address&&x(s.address)}catch(e){console.error(e)}})()},[null==e?void 0:e.accessToken]);let A=async t=>{t.preventDefault();let s=!1;if(y){i.Ay.error("Vennligst sjekk kallenavnet ditt.");return}if(m?f(""):(f("Du m\xe5 velge et selskap."),s=!0),k.trim()?S(""):(S("Addressefeltet kan ikke st\xe5 tomt."),s=!0),!s){if(!(null==e?void 0:e.accessToken)||!m||!g||!k){i.Ay.error("Vennligst fyll ut alle feltene.");return}w(!0);try{if(!(await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/Profile/companySet",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({companyId:m,nickName:g,address:k})})).ok)throw Error("Klarte ikke oppdatere profil");console.log("Brukerdata oppdatert"),T.push("/")}catch(e){console.error(e)}finally{w(!1)}}};return(0,a.jsx)("div",{className:"bg-customYellow2 p-6 flex flex-col justify-center items-center",children:(0,a.jsxs)("div",{className:"w-full max-w-md bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-customViolet mb-6 text-center",children:"Fullf\xf8r profilen din"}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Velg selskap:"}),(0,a.jsxs)("select",{className:"w-full p-3 mb-4 rounded border",value:null!=m?m:"",onChange:e=>h(Number(e.target.value)),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Velg et selskap"}),t.map(e=>(0,a.jsx)("option",{value:e.companyId,children:e.name},e.companyId))]}),p&&(0,a.jsx)("p",{className:"text-customRed -mt-4 text-sm py-2",children:p}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Kallenavn:"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 mb-1 rounded border",value:g,onChange:_,placeholder:"F.eks. SuperPer"}),y&&(0,a.jsx)("p",{className:"text-customRed text-sm mb-4",children:y}),(0,a.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Adresse:"}),(0,a.jsx)(o.A,{selectedAddress:k,setSelectedAddress:x}),j&&(0,a.jsx)("p",{className:"text-customRed -mt-2 text-sm py-2",children:j}),(0,a.jsx)("button",{onClick:A,disabled:v||!!y,className:"w-full bg-customViolet text-white p-3 rounded font-semibold hover:opacity-90 transition",children:v?"Lagrer...":"Fullf\xf8r"})]})})}},4957:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(7876),r=s(4232),l=s(300);function n(e){let{selectedAddress:t,setSelectedAddress:s,inputBgClass:n="bg-white"}=e,[o,c]=(0,r.useState)(t),[i,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),{userData:f}=(0,l.r)();async function g(e){m(!0);try{if(!(null==f?void 0:f.accessToken))return;let t=await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/geocode?address=".concat(encodeURIComponent(e)),{headers:{Authorization:"Bearer ".concat(f.accessToken)}});if(!t.ok){console.error("Failed to fetch suggestions"),d([]);return}let s=await t.json();d(s.features||[])}catch(e){console.error("Error fetching suggestions",e),d([])}finally{m(!1)}}(0,r.useEffect)(()=>{c(t)},[t]),(0,r.useEffect)(()=>{if(!o.trim()){d([]);return}let e=setTimeout(()=>{g(o)},500);return()=>clearTimeout(e)},[o]);let b=e=>{c(e.properties.label),s(e.properties.label),d([]),p(!1)};return(0,a.jsxs)("div",{className:"address-autocomplete relative",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsx)("input",{type:"text",value:o,placeholder:"F.eks. Storgata 1, Oslo",onChange:e=>{c(e.target.value)},onFocus:()=>p(!0),onBlur:()=>{setTimeout(()=>{p(!1),o!==t&&c(t)},150)},className:"w-full p-3 pr-8 rounded border border-gray-300 ".concat(n," focus:outline-none focus:ring-2 focus:ring-customViolet")}),o&&(0,a.jsx)("button",{onClick:()=>{c(""),s(""),d([])},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),h&&!u&&i.length>0&&o.trim()&&(0,a.jsx)("ul",{className:"absolute z-10 w-full border border-gray-200 rounded shadow-md bg-white max-h-60 overflow-y-auto",children:i.map((e,t)=>(0,a.jsx)("li",{onMouseDown:()=>b(e),className:"p-2 hover:bg-gray-100 cursor-pointer",children:e.properties.label},"".concat(e.properties.osm_id,"-").concat(t)))}),h&&u&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-customViolet",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),(0,a.jsx)("span",{className:"text-gray-600",children:"Laster adresser..."})]}),h&&!u&&0===i.length&&o.trim()&&(0,a.jsxs)("div",{className:"p-2 text-gray-500 border rounded",children:["Ingen treff p\xe5 “",o,"”"]})]})}},6250:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding",function(){return s(3792)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6250)),_N_E=e.O()}]);