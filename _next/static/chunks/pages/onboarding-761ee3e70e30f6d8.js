(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{300:(e,t,a)=>{"use strict";a.d(t,{r:()=>o});var l=a(4232),n=a(5051),r=a(4723),s=a(7526);let o=()=>{let{instance:e,accounts:t}=(0,n.dk)(),[a,o]=(0,l.useState)(null),[i,c]=(0,l.useState)(!0),[u,d]=(0,l.useState)(null),m=async t=>{try{var a;let l=await e.acquireTokenSilent({scopes:r.$.scopes,account:t}),n=l.idTokenClaims,s={email:(null===(a=n.emails)||void 0===a?void 0:a[0])||n.email||n.preferred_username||"",name:n.name||"".concat(n.given_name||""," ").concat(n.family_name||"").trim()||"Unknown User",idTokenClaims:n,idToken:l.idToken,accessToken:l.accessToken};o(s)}catch(t){if(t instanceof s.CB)try{await e.loginRedirect(r.$)}catch(e){d("Login required: "+e)}else d("Failed to acquire token: "+t)}};return(0,l.useEffect)(()=>{(async()=>{try{let a;await e.initialize(),await e.handleRedirectPromise()?a=e.getAllAccounts()[0]:t.length>0&&(a=t[0]),a&&await m(a)}catch(e){d("MSAL initialization error: "+e)}finally{c(!1)}})()},[e]),{userData:a,loading:i,error:u}}},3792:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var l=a(7876),n=a(4232),r=a(300),s=a(9099);function o(){let{userData:e}=(0,r.r)(),[t,a]=(0,n.useState)([]),[o,i]=(0,n.useState)(null),[c,u]=(0,n.useState)(""),[d,m]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),f=(0,s.useRouter)();(0,n.useEffect)(()=>{(null==e?void 0:e.accessToken)&&(async()=>{try{let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/allComp",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av selskaper");let l=await t.json();a(l)}catch(e){console.error("❌ Kunne ikke hente selskaper:",e)}})()},[null==e?void 0:e.accessToken]);let k=async()=>{if(!(null==e?void 0:e.accessToken)||!o||!c||!d){alert("Vennligst fyll ut alle felter.");return}p(!0);try{if(!(await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/companySet",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({companyId:o,nickName:c,address:d})})).ok)throw Error("Klarte ikke oppdatere profil");console.log("✅ Brukerdata oppdatert"),f.push("/")}catch(e){console.error("❌ Feil under lagring:",e),alert("Noe gikk galt. Pr\xf8v igjen.")}finally{p(!1)}};return(0,l.jsx)("div",{className:"min-h-screen bg-customYellow2 p-6 flex flex-col justify-center items-center",children:(0,l.jsxs)("div",{className:"w-full max-w-md bg-white p-6 rounded-lg shadow-md",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-customViolet mb-6 text-center",children:"Fullf\xf8r profilen din"}),(0,l.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Velg selskap:"}),(0,l.jsxs)("select",{className:"w-full p-3 mb-4 rounded border",value:null!=o?o:"",onChange:e=>i(Number(e.target.value)),children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Velg et selskap"}),t.map(e=>(0,l.jsx)("option",{value:e.companyId,children:e.name},e.companyId))]}),(0,l.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Kallenavn:"}),(0,l.jsx)("input",{type:"text",className:"w-full p-3 mb-4 rounded border",value:c,onChange:e=>u(e.target.value),placeholder:"F.eks. SuperPer"}),(0,l.jsx)("label",{className:"block mb-2 font-medium text-gray-700",children:"Adresse:"}),(0,l.jsx)("input",{type:"text",className:"w-full p-3 mb-6 rounded border",value:d,onChange:e=>m(e.target.value),placeholder:"F.eks. Storgata 1, Oslo"}),(0,l.jsx)("button",{onClick:k,disabled:h,className:"w-full bg-customViolet text-white p-3 rounded font-semibold hover:opacity-90 transition",children:h?"Lagrer...":"Fullf\xf8r"})]})})}},6250:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding",function(){return a(3792)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6250)),_N_E=e.O()}]);