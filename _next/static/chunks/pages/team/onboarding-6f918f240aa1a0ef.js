(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{300:(e,t,a)=>{"use strict";a.d(t,{r:()=>i});var n=a(4232),s=a(5051),r=a(4723),l=a(7526);let i=()=>{let{instance:e,accounts:t}=(0,s.dk)(),[a,i]=(0,n.useState)(null),[c,o]=(0,n.useState)(!0),[d,m]=(0,n.useState)(null),u=async t=>{try{var a;let n=await e.acquireTokenSilent({scopes:r.$.scopes,account:t}),s=n.idTokenClaims,l={email:(null===(a=s.emails)||void 0===a?void 0:a[0])||s.email||s.preferred_username||"",name:s.name||"".concat(s.given_name||""," ").concat(s.family_name||"").trim()||"Unknown User",idTokenClaims:s,idToken:n.idToken,accessToken:n.accessToken};i(l)}catch(t){if(t instanceof l.CB)try{await e.loginRedirect(r.$)}catch(e){m("Login required: "+e)}else m("Failed to acquire token: "+t)}};return(0,n.useEffect)(()=>{(async()=>{try{let a;await e.initialize(),await e.handleRedirectPromise()?a=e.getAllAccounts()[0]:t.length>0&&(a=t[0]),a&&await u(a)}catch(e){m("MSAL initialization error: "+e)}finally{o(!1)}})()},[e]),{userData:a,loading:c,error:d}}},345:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var n=a(7876),s=a(4232);let r=e=>{let{onClick:t,children:a,className:s="",disabled:r=!1,variant:l="primary"}=e,i={primary:"bg-customViolet text-white",secondary:"bg-customGreen text-white"},c=r?"bg-gray-400 text-gray-700 cursor-not-allowed":i[l]||i.primary;return(0,n.jsx)("button",{onClick:t,disabled:r,className:"".concat("py-3 px-4 w-full sm:w-auto flex-grow rounded-md font-medium flex items-center justify-center gap-2 whitespace-nowrap"," ").concat(c," ").concat(s),children:a})};var l=a(1713);let i=(0,l.A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),c=(0,l.A)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);function o(e){let{onCreate:t,onJoin:a}=e;return(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-lg mx-auto",children:[(0,n.jsxs)(r,{onClick:t,variant:"primary",className:"flex-1",children:[(0,n.jsx)(i,{size:20}),"Opprett et lag"]}),(0,n.jsxs)(r,{onClick:a,variant:"secondary",className:"flex-1",children:[(0,n.jsx)(c,{size:20}),"Bli med i et lag"]})]})}function d(e){let{teamName:t,setTeamName:a,accessToken:r,onCreateTeam:l,onBack:i}=e,[c,o]=(0,s.useState)(!1),[d,m]=(0,s.useState)(""),u=async()=>{o(!0),m("");try{let e=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/team/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({name:t,companyId:1})});if(!e.ok){let t=await e.text();throw Error(t||"Noe gikk galt under oppretting av lag.")}l()}catch(e){console.error("Create team error:",e),m(e.message||"Ukjent feil")}finally{o(!1)}};return(0,n.jsxs)("div",{className:"flex flex-col gap-4 mt-4",children:[(0,n.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"Skriv inn lagnavn...",className:"p-2 border border-gray-400 rounded-md"}),(0,n.jsx)("button",{onClick:u,disabled:!t.trim()||c,className:"py-3 rounded-md text-white font-medium ".concat(t.trim()&&!c?"bg-customViolet":"bg-gray-400 cursor-not-allowed"),children:c?"Oppretter...":"Opprett lag"}),d&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:d}),(0,n.jsx)("button",{onClick:i,className:"text-gray-600 hover:text-black",children:"Tilbake"})]})}function m(e){let{selectedTeam:t,setSelectedTeam:a,existingTeams:r,accessToken:l,onJoinTeam:i,onBack:c}=e,[o,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(""),h=async()=>{d(!0),u("");try{let e=parseInt(t);if(!r.find(t=>t.teamId===e))throw Error("Fant ikke valgt lag.");let a=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/team/join",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({teamId:e})});if(!a.ok){let e=await a.text();throw Error(e||"Kunne ikke bli med i laget.")}i()}catch(e){console.error("Join team error:",e),u(e.message||"Ukjent feil")}finally{d(!1)}};return(0,n.jsxs)("div",{className:"flex flex-col gap-4 mt-4",children:[(0,n.jsxs)("select",{value:t,onChange:e=>a(e.target.value),className:"p-2 border border-gray-400 rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Velg et lag..."}),r.map(e=>(0,n.jsx)("option",{value:e.teamId,children:e.name},e.teamId))]}),(0,n.jsx)("button",{onClick:h,disabled:!t||o,className:"py-3 rounded-md text-white font-medium ".concat(t&&!o?"bg-customGreen":"bg-gray-400 cursor-not-allowed"),children:o?"Bli med...":"Bli med i laget"}),m&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:m}),(0,n.jsx)("button",{onClick:c,className:"text-gray-600 hover:text-black",children:"Tilbake"})]})}var u=a(9099),h=a(300);function x(){let[e,t]=(0,s.useState)(""),[a,r]=(0,s.useState)(""),[l,i]=(0,s.useState)(""),[c,x]=(0,s.useState)([]),[p,f]=(0,s.useState)(!0),g=(0,u.useRouter)(),{userData:y,loading:k,error:w}=(0,h.r)();(0,s.useEffect)(()=>{(null==y?void 0:y.accessToken)&&(async()=>{try{let e=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Team/company",{headers:{Authorization:"Bearer ".concat(y.accessToken)}});if(!e.ok)throw Error("Feil ved henting av lag: ".concat(e.statusText));let t=await e.json();x(t)}catch(e){console.error("Feil ved henting av lag:",e)}finally{f(!1)}})()},[null==y?void 0:y.accessToken]);let v=()=>{g.replace("/team/dashboard")};return k||p?(0,n.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,n.jsx)("p",{children:"Laster inn..."})}):!w&&(null==y?void 0:y.accessToken)?(0,n.jsx)("main",{className:"fixed inset-0 bg-customYellow2 flex flex-col items-center px-4 pt-4 pb-24",children:(0,n.jsxs)("div",{className:"w-full max-w-xs sm:max-w-md flex flex-col gap-4 mt-16 text-center",children:[(0,n.jsx)("p",{className:"text-lg sm:text-xl font-medium text-black",children:"Du er ikke medlem av et lag:"}),""===e&&(0,n.jsx)(o,{onCreate:()=>t("create"),onJoin:()=>t("join")}),"create"===e&&(0,n.jsx)(d,{teamName:a,setTeamName:r,accessToken:y.accessToken,onCreateTeam:v,onBack:()=>t("")}),"join"===e&&(0,n.jsx)(m,{selectedTeam:l,setSelectedTeam:i,existingTeams:c,accessToken:y.accessToken,onJoinTeam:v,onBack:()=>t("")})]})}):(0,n.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,n.jsx)("p",{children:"Kunne ikke laste inn. Vennligst logg inn p\xe5 nytt."})})}},1468:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/team/onboarding",function(){return a(345)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(1468)),_N_E=e.O()}]);