(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{28:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var a=n(7876),l=n(4232);let r=e=>{let{onClick:t,children:n,className:l="",disabled:r=!1,variant:s="primary"}=e,i={primary:"bg-customViolet text-white",secondary:"bg-customGreen text-white"},c=r?"bg-gray-400 text-gray-700 cursor-not-allowed":i[s]||i.primary;return(0,a.jsx)("button",{onClick:t,disabled:r,className:"".concat("py-3 px-4 w-full sm:w-auto flex-grow rounded-md font-medium flex items-center justify-center gap-2 whitespace-nowrap"," ").concat(c," ").concat(l),children:n})},s=(0,n(1713).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function i(e){let{onCreate:t}=e;return(0,a.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-lg mx-auto",children:(0,a.jsxs)(r,{onClick:t,variant:"primary",className:"flex-1",children:[(0,a.jsx)(s,{size:20}),"Opprett et lag"]})})}var c=n(724),o=n(9099),d=n.n(o);function m(e){let{teamName:t,setTeamName:n,accessToken:r,onCreateTeam:s,onBack:i}=e,[o,m]=(0,l.useState)(!1),[u,x]=(0,l.useState)(null),h=async()=>{m(!0);try{let e=await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/team/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({name:t})});if(!e.ok){if(428===e.status){d().push("/onboarding");return}let t=await e.text();throw Error(t||"Noe gikk galt under oppretting av lag.")}s()}catch(e){return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}finally{m(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col gap-4 mt-4",children:[(0,a.jsx)("input",{type:"text",value:t,onChange:e=>{let t=e.target.value;n(t),x((0,c.y)(t,{maxLength:12,label:"Lagnavn"}))},placeholder:"Skriv inn lagnavn...",className:"p-2 border border-gray-400 rounded-md"}),u&&(0,a.jsx)("p",{className:"text-customRed text-sm",children:u}),(0,a.jsx)("button",{onClick:h,disabled:!t.trim()||o||!!u,className:"py-3 rounded-md text-white font-medium ".concat(!t.trim()||o||u?"bg-gray-400 cursor-not-allowed":"bg-customViolet"),children:o?"Oppretter...":"Opprett lag"}),(0,a.jsx)("button",{onClick:i,className:"text-gray-600 hover:text-black",children:"Tilbake"})]})}function u(e){let{existingTeams:t,accessToken:n,onJoinTeam:r,onBack:s}=e,[i,c]=(0,l.useState)(!1),o=t.filter(e=>e.memberCount<5),d=t.filter(e=>e.memberCount>=5),m=async e=>{c(!0);try{if(!t.find(t=>t.teamId===e))throw Error("Fant ikke valgt lag.");let a=await fetch("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net/api/team/join",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({teamId:e})});if(!a.ok){let e=await a.text();throw Error(e||"Kunne ikke bli med i laget.")}r()}catch(e){return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}finally{c(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col gap-8 mt-4",children:[o.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-customViolet",children:"Ledige lag"}),o.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:e.name}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Medlemmer: ",e.memberCount," / 5"]})]}),(0,a.jsx)("button",{onClick:()=>m(e.teamId),disabled:i,className:"w-full py-2 mt-4 rounded-md text-white font-medium bg-customGreen hover:bg-green-600",children:i?"Bli med...":"Bli med i laget"})]},e.teamId))]}),d.length>0&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-gray-100 rounded-xl shadow-inner p-4 mt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-700 mb-4",children:"Fulltallige lag"}),d.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:e.name}),(0,a.jsxs)("p",{className:"text-gray",children:["Medlemmer: ",e.memberCount," / 5"]})]}),(0,a.jsx)("button",{disabled:!0,className:"w-full py-2 mt-4 rounded-md text-white font-medium bg-gray-400 cursor-not-allowed",children:"Lag fullt"})]},e.teamId))]})})]})}var x=n(300),h=n(3784),g=n(7644);function f(){let[e,t]=(0,l.useState)(""),[n,r]=(0,l.useState)(""),s=(0,o.useRouter)(),{userData:c,loading:d,error:f}=(0,x.r)(),{data:p,isLoading:b,error:v}=(0,h.g)("/api/Team/company",null==c?void 0:c.accessToken,{refreshInterval:3e4,enabled:!!(null==c?void 0:c.accessToken)});if(d||b)return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(g.A,{})});if(f||v||!(null==c?void 0:c.accessToken))return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})});let j=()=>{s.replace("/team/dashboard")};return(0,a.jsxs)("main",{className:"flex flex-col items-center px-4",children:[(0,a.jsx)("div",{className:"w-full text-center",children:(0,a.jsx)("div",{className:"font-bold text-3xl text-violet-950",children:"Velg Lag"})}),(0,a.jsxs)("div",{className:"w-full max-w-xs sm:max-w-md flex flex-col gap-4 mt-6 text-center",children:[(0,a.jsx)("p",{className:"text-lg sm:text-xl font-medium text-black",children:"Du er ikke medlem av et lag:"}),""===e&&(0,a.jsxs)(a.Fragment,{children:[(null==p?void 0:p.length)===0?(0,a.jsx)("p",{children:"Det finnes ingen lag enn\xe5. Du kan v\xe6re den f\xf8rste til \xe5 lage ett!"}):(0,a.jsx)("p",{children:"Bli med i et lag, eller opprett ditt eget."}),(0,a.jsx)(i,{onCreate:()=>t("create")})]}),"create"===e&&(0,a.jsx)(m,{teamName:n,setTeamName:r,accessToken:c.accessToken,onCreateTeam:j,onBack:()=>t("")}),(0,a.jsx)(u,{existingTeams:p||[],accessToken:c.accessToken,onJoinTeam:j,onBack:()=>t("")})]})]})}},724:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var a=n(1367),l=n.n(a);function r(e,t){var n,a,r;let s=null!==(n=null==t?void 0:t.minLength)&&void 0!==n?n:3,i=null!==(a=null==t?void 0:t.maxLength)&&void 0!==a?a:15,c=null!==(r=null==t?void 0:t.label)&&void 0!==r?r:"Kallenavn";return e.length<s?"".concat(c," m\xe5 v\xe6re minst ").concat(s," tegn."):e.length>i?"".concat(c," kan ikke v\xe6re lengre enn ").concat(i," tegn."):/^[A-Za-zÆØÅæøå0-9_ ]+$/.test(e)?l().check(e)||l().list().some(t=>e.toLowerCase().includes(t))?"Dette kallenavnet inneholder upassende spr\xe5k.":null:"Kallenavn kan kun inneholde bokstaver, tall, mellomrom og understrek."}},1468:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/team/onboarding",function(){return n(28)}])},3784:(e,t,n)=>{"use strict";n.d(t,{g:()=>c});var a=n(7596),l=n(9099),r=n.n(l),s=n(7685);async function i(e,t){let n={"Content-Type":"application/json"};t&&(n.Authorization="Bearer ".concat(t));let a=await fetch("".concat("https://kortreistapi-h7e9d7gsb3bcgwhd.norwayeast-01.azurewebsites.net").concat(e),{headers:n});if(!a.ok){if(428===a.status){s.Ay.error("Du m\xe5 fullf\xf8re registreringen f\xf8r du kan fortsette."),r().push("/onboarding");return}let e=await a.text();throw Error("Error: ".concat(a.statusText," - ").concat(e))}return a.json()}function c(e,t,n){var l;let r=(null===(l=null==n?void 0:n.enabled)||void 0===l||l)&&e&&t?[e,t]:null,{data:s,error:c,mutate:o}=(0,a.Ay)(r,()=>i(e,t),n);return{data:s,isLoading:!s&&!c,error:c,mutate:o}}},7644:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(7876);function l(){return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-customViolet"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[596,636,593,792],()=>t(1468)),_N_E=e.O()}]);