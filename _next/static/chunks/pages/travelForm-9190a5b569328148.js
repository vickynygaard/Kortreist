(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{96:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/travelForm",function(){return l(3447)}])},300:(e,t,l)=>{"use strict";l.d(t,{r:()=>n});var s=l(4232),a=l(5051),r=l(4723),i=l(7526);let n=()=>{let{instance:e,accounts:t}=(0,a.dk)(),[l,n]=(0,s.useState)(null),[c,o]=(0,s.useState)(!0),[d,u]=(0,s.useState)(null),m=async t=>{try{var l;let s=await e.acquireTokenSilent({scopes:r.$.scopes,account:t}),a=s.idTokenClaims,i={email:(null===(l=a.emails)||void 0===l?void 0:l[0])||a.email||a.preferred_username||"",name:a.name||"".concat(a.given_name||""," ").concat(a.family_name||"").trim()||"Unknown User",idTokenClaims:a,idToken:s.idToken,accessToken:s.accessToken};n(i)}catch(t){if(t instanceof i.CB)try{await e.loginRedirect(r.$)}catch(e){u("Login required: "+e)}else u("Failed to acquire token: "+t)}};return(0,s.useEffect)(()=>{(async()=>{try{let l;await e.initialize(),await e.handleRedirectPromise()?l=e.getAllAccounts()[0]:t.length>0&&(l=t[0]),l&&await m(l)}catch(e){u("MSAL initialization error: "+e)}finally{o(!1)}})()},[e]),{userData:l,loading:c,error:d}}},3447:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>x});var s=l(7876),a=l(4232);let r=(0,l(1713).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),i=e=>{let{userId:t,address:l,setAddress:a}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("label",{className:"block font-semibold text-lg pb-2",children:"Hjem"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-violet-900",children:(0,s.jsx)(r,{size:20})}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>a(e.target.value),placeholder:"Skriv inn adresse",className:"w-full bg-customYellow2 border-2 border-violet-900 rounded-lg pl-10 pr-3 py-2"})]})]})};var n=l(4587),c=l.n(n);let o=e=>{let{icon:t,label:l,selected:a=!1,onClick:r}=e;return(0,s.jsxs)("button",{type:"button",onClick:r,className:"".concat("flex flex-col items-center justify-center gap-2 w-full aspect-[5/4] bg-customYellow2 border-2 rounded-xl transition"," ").concat(a?"border-violet-600 bg-violet-100":"border-violet-900"),children:[(0,s.jsx)("div",{className:"w-16 h-16 relative",children:(0,s.jsx)(c(),{src:t,alt:l,layout:"fill",objectFit:"contain"})}),(0,s.jsx)("span",{className:"font-medium px-4",children:l})]})},d=e=>{let{title:t,type:l="button",onClick:a}=e;return(0,s.jsx)("button",{type:l,onClick:a,className:"flex flex-col items-center justify-center w-full bg-violet-900 text-white px-4 py-2 rounded-lg transition",children:(0,s.jsx)("span",{className:"text-lg font-semibold",children:t})})};var u=l(6955),m=l(9099),v=l(300);let f="/Kortreist",h=[{label:"Gange",value:"walking",iconSrc:"".concat(f,"/images/travelForm/Gange.svg")},{label:"Sykkel",value:"cycling",iconSrc:"".concat(f,"/images/travelForm/Sykkel.svg")},{label:"Kollektivtransport",value:"bus",iconSrc:"".concat(f,"/images/travelForm/Kollektiv.svg")},{label:"Samkj\xf8ring",value:"car",iconSrc:"".concat(f,"/images/travelForm/Carpool.svg")}];function x(){let{userData:e}=(0,v.r)(),t=(0,m.useRouter)(),[l,r]=(0,a.useState)(null),[n,c]=(0,a.useState)(""),[f,x]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),k=async()=>{if(null==e?void 0:e.accessToken)try{let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/Profile/getUser",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!t.ok)throw Error("Feil ved henting av brukerdata: ".concat(t.statusText));let l=await t.json();console.log("✅ Fetched user profile:",l),l.address&&c(l.address)}catch(e){console.error("Feil ved henting av brukerdata:",e)}};(0,a.useEffect)(()=>{(null==e?void 0:e.accessToken)&&k()},[null==e?void 0:e.accessToken]);let b=async t=>{t.preventDefault();let s=!1;if(l?g(""):(g("Husk \xe5 velge reisem\xe5te."),s=!0),n.trim()?x(""):(x("Addressefeltet kan ikke st\xe5 tomt."),s=!0),!s)try{if(!(null==e?void 0:e.accessToken)||!(null==e?void 0:e.email))throw Error("Mangler autentisering eller e-post.");let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/transportEntry/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({email:e.email,startingAddress:n,method:null==l?void 0:l.value})});if(!t.ok)throw Error("Serverfeil: ".concat(t.statusText));let s=await t.json();console.log("✅ Registrering vellykket:",s),alert("Reise registrert!")}catch(e){console.error("Feil ved innsending:",e),alert("Klarte ikke \xe5 registrere turen. Pr\xf8v igjen senere.")}};return(0,s.jsxs)("div",{className:"flex flex-col items-center px-4",children:[(0,s.jsx)("header",{className:"self-start",children:(0,s.jsx)(u.A,{onClick:()=>t.back()})}),(0,s.jsx)("div",{className:"font-bold text-3xl text-violet-950 pb-6",children:"Registrer reise"}),(0,s.jsxs)("form",{onSubmit:b,className:"flex flex-col gap-y-6 w-full",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(i,{userId:"bruker123",address:n,setAddress:c}),f&&(0,s.jsx)("p",{className:"text-red-800 text-sm py-2",children:f})]}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("label",{className:"block font-semibold text-lg pb-2",children:"Reisem\xe5te"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:h.map(e=>{let{label:t,value:a,iconSrc:i}=e;return(0,s.jsx)(o,{label:t,value:a,icon:i,selected:(null==l?void 0:l.value)===a,onClick:()=>r({label:t,value:a})},t)})}),p&&(0,s.jsx)("p",{className:"text-red-800 text-sm py-2",children:p})]}),(0,s.jsx)("div",{id:"submit",className:"w-full mt-8",children:(0,s.jsx)(d,{title:"Registrer",type:"submit"})})]})]})}},6955:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var s=l(7876);let a=(0,l(1713).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),r=e=>{let{icon:t=(0,s.jsx)(a,{size:24}),onClick:l}=e;return(0,s.jsx)("button",{onClick:l,className:"flex items-center",children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(96)),_N_E=e.O()}]);