(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{96:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/travelForm",function(){return s(8132)}])},4957:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(7876),l=s(4232),a=s(300);function n(e){let{selectedAddress:t,setSelectedAddress:s,inputBgClass:n="bg-white"}=e,[i,c]=(0,l.useState)(t),[o,u]=(0,l.useState)([]),[d,f]=(0,l.useState)(!1),[h,m]=(0,l.useState)(!1),{userData:p}=(0,a.r)();async function x(e){f(!0);try{if(!(null==p?void 0:p.accessToken))return;let t=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/geocode?address=".concat(encodeURIComponent(e)),{headers:{Authorization:"Bearer ".concat(p.accessToken)}});if(!t.ok){console.error("Failed to fetch suggestions"),u([]);return}let s=await t.json();u(s.features||[])}catch(e){console.error("Error fetching suggestions",e),u([])}finally{f(!1)}}(0,l.useEffect)(()=>{c(t)},[t]),(0,l.useEffect)(()=>{if(!i.trim()){u([]);return}let e=setTimeout(()=>{x(i)},500);return()=>clearTimeout(e)},[i]);let g=e=>{c(e.properties.label),s(e.properties.label),u([]),m(!1)};return(0,r.jsxs)("div",{className:"address-autocomplete relative",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsx)("input",{type:"text",value:i,placeholder:"F.eks. Storgata 1, Oslo",onChange:e=>{c(e.target.value)},onFocus:()=>m(!0),onBlur:()=>{setTimeout(()=>{m(!1),i!==t&&c(t)},150)},className:"w-full p-3 rounded border ".concat(n," focus:outline-none focus:ring-2 focus:ring-customViolet")}),i&&(0,r.jsx)("button",{onClick:()=>{c(""),s(""),u([])},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),h&&!d&&o.length>0&&i.trim()&&(0,r.jsx)("ul",{className:"absolute z-10 w-full border border-gray-200 rounded shadow-md bg-white max-h-60 overflow-y-auto",children:o.map((e,t)=>(0,r.jsx)("li",{onMouseDown:()=>g(e),className:"p-2 hover:bg-gray-100 cursor-pointer",children:e.properties.label},"".concat(e.properties.osm_id,"-").concat(t)))}),h&&d&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-customViolet",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),(0,r.jsx)("span",{className:"text-gray-600",children:"Laster adresser..."})]}),h&&!d&&0===o.length&&i.trim()&&(0,r.jsxs)("div",{className:"p-2 text-gray-500 border rounded",children:["Ingen treff p\xe5 “",i,"”"]})]})}},5577:(e,t,s)=>{"use strict";s.d(t,{g:()=>c});var r=s(6768),l=s(9099),a=s.n(l),n=s(7685);async function i(e,t){let s={"Content-Type":"application/json"};t&&(s.Authorization="Bearer ".concat(t));let r=await fetch("".concat("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net").concat(e),{headers:s});if(!r.ok){if(428===r.status){n.Ay.error("Du m\xe5 fullf\xf8re registreringen f\xf8r du kan fortsette."),a().push("/onboarding");return}let e=await r.text();throw Error("Error: ".concat(r.statusText," - ").concat(e))}return r.json()}function c(e,t,s){let l=e&&t?[e,t]:null,{data:a,error:n,mutate:c}=(0,r.Ay)(l,l?()=>i(e,t):null,s);return{data:a,isLoading:!a&&!n,error:n,mutate:c}}},6955:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(7876);let l=(0,s(1713).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),a=e=>{let{icon:t=(0,r.jsx)(l,{size:24}),onClick:s}=e;return(0,r.jsx)("button",{onClick:s,className:"flex items-center",children:t})}},8132:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(7876),l=s(4232),a=s(4957),n=s(4587),i=s.n(n);let c=e=>{let{icon:t,label:s,selected:l=!1,onClick:a}=e;return(0,r.jsxs)("button",{type:"button",onClick:a,className:"".concat("flex flex-col items-center justify-center gap-2 w-full aspect-[5/4] bg-customYellow2 border-2 rounded-xl transition"," ").concat(l?"border-violet-600 bg-violet-100":"border-violet-900"),children:[(0,r.jsx)("div",{className:"w-16 h-16 relative",children:(0,r.jsx)(i(),{src:t,alt:s,layout:"fill",objectFit:"contain"})}),(0,r.jsx)("span",{className:"font-medium px-4",children:s})]})},o=e=>{let{title:t,type:s="button",onClick:l,disabled:a,...n}=e;return(0,r.jsx)("button",{type:s,onClick:l,disabled:a,className:"flex flex-col items-center justify-center w-full bg-violet-900 text-white px-4 py-2 rounded-lg transition ".concat(a?"opacity-50 cursor-not-allowed":""),...n,children:(0,r.jsx)("span",{className:"text-lg font-semibold",children:t})})};var u=s(6955),d=s(9099),f=s(300),h=s(7685),m=s(5577),p=s(7644);let x="/Kortreist",g=[{label:"Gange",value:"walking",iconSrc:"".concat(x,"/images/travelForm/Gange.svg")},{label:"Sykkel",value:"cycling",iconSrc:"".concat(x,"/images/travelForm/Sykkel.svg")},{label:"Kollektivtransport",value:"bus",iconSrc:"".concat(x,"/images/travelForm/Kollektiv.svg")},{label:"Samkj\xf8ring",value:"car",iconSrc:"".concat(x,"/images/travelForm/Carpool.svg")}];function v(){let{userData:e}=(0,f.r)(),t=(0,d.useRouter)(),s=(null==e?void 0:e.accessToken)?"/api/Profile/getUser":null,{data:n,isLoading:i,error:x}=(0,m.g)(s,null==e?void 0:e.accessToken,{refreshInterval:3e4}),[v,b]=(0,l.useState)(""),[j,y]=(0,l.useState)(null),[w,k]=(0,l.useState)(""),[N,S]=(0,l.useState)(""),[A,C]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{n&&n.address&&b(n.address)},[n]),i)return(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)(p.A,{})});if(x)return(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})});let T=async s=>{s.preventDefault();let l=!1;if(j?S(""):(S("Husk \xe5 velge reisem\xe5te."),l=!0),v.trim()?k(""):(k("Addressefeltet kan ikke st\xe5 tomt."),l=!0),!l){C(!0);try{if(!(null==e?void 0:e.accessToken)||!(null==e?void 0:e.email))throw Error("Mangler autentisering eller e-post.");let s=await fetch("https://bouvetapi-frbah7fhh5cjdpfy.swedencentral-01.azurewebsites.net/api/transportEntry/upsert",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.accessToken)},body:JSON.stringify({startingAddress:v,method:null==j?void 0:j.value})});if(!s.ok)throw Error("Serverfeil: ".concat(s.statusText));let r=await s.json();console.log("Registrering vellykket:",r),h.Ay.success("Reise registrert!"),t.push("/")}catch(e){return(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("p",{children:"Her skjedde det noe galt, pr\xf8v \xe5 laste inn p\xe5 nytt"})})}finally{C(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col items-center px-4",children:[(0,r.jsx)("header",{className:"self-start",children:(0,r.jsx)(u.A,{onClick:()=>t.back()})}),(0,r.jsx)("div",{className:"font-bold text-3xl text-violet-950 pb-6",children:"Registrer reise"}),(0,r.jsxs)("form",{onSubmit:T,className:"flex flex-col gap-y-6 w-full",children:[(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(a.A,{selectedAddress:v,setSelectedAddress:b}),w&&(0,r.jsx)("p",{className:"text-red-800 text-sm py-2",children:w})]}),(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("label",{className:"block font-semibold text-lg pb-2",children:"Reisem\xe5te"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4",children:g.map(e=>{let{label:t,value:s,iconSrc:l}=e;return(0,r.jsx)(c,{label:t,value:s,icon:l,selected:(null==j?void 0:j.value)===s,onClick:()=>y({label:t,value:s})},t)})}),N&&(0,r.jsx)("p",{className:"text-red-800 text-sm py-2",children:N})]}),(0,r.jsx)("div",{id:"submit",className:"w-full mt-8",children:(0,r.jsx)(o,{title:"Registrer",type:"submit",disabled:A})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[768,636,593,792],()=>t(96)),_N_E=e.O()}]);